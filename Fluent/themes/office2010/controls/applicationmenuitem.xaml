<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:Fluent="clr-namespace:Fluent">
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="pack://application:,,,/Fluent;component\Themes\Office2010\Controls\RibbonScrollViewer.xaml"/>
    <ResourceDictionary Source="pack://application:,,,/Fluent;component\Themes\Office2010\Controls\MenuItem.xaml"/>
  </ResourceDictionary.MergedDictionaries>
  <Fluent:ObjectToImageConverter x:Key="StringToImageConvert"/>
  <Fluent:ApplicationMenuRightContentExtractorConverter x:Key="ApplicationMenuRightContentExtractorConvert"/>
  <ControlTemplate x:Key="ApplicationMenuSecondLevelItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="53" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
              Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
              BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
              Grid.Column="0" Grid.ColumnSpan="3">
        <Border Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"/>
      </Border>
      <TextBlock x:Name="textBlock_Copy" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,13,3" VerticalAlignment="Center" Grid.Column="1"
                 TextTrimming="None" Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,3,3" VerticalAlignment="Top" Grid.Column="1"
                 TextTrimming="CharacterEllipsis"/>
      <TextBlock x:Name="textBlockDesc" Text="{TemplateBinding Fluent:MenuItem.Description}" Width="Auto"
                 HorizontalAlignment="Stretch" Height="Auto" Margin="9,22,3,3" VerticalAlignment="Top"
                 Grid.Column="1" TextWrapping="Wrap"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,4,0,0"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Top"
                        Margin="3,4,2,2" Width="32" RenderOptions.BitmapScalingMode="NearestNeighbor"
                        SnapsToDevicePixels="true"
                        Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToImageConvert}}"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="border" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="HeaderApplicationMenuSecondLevelItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
      <Style TargetType="{x:Type Fluent:MenuItem}" BasedOn="{StaticResource MenuItemStyle}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="53" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
              Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
              BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
              Grid.Column="0" Grid.ColumnSpan="3">
        <Border Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"/>
      </Border>
      <TextBlock x:Name="textBlock_Copy" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,13,3" VerticalAlignment="Center" Grid.Column="1"
                 TextTrimming="None" Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,3,3" VerticalAlignment="Top" Grid.Column="1"
                 TextTrimming="CharacterEllipsis"/>
      <TextBlock x:Name="textBlockDesc" Text="{TemplateBinding Fluent:MenuItem.Description}" Width="Auto"
                 HorizontalAlignment="Stretch" Height="Auto" Margin="9,22,3,3" VerticalAlignment="Top"
                 Grid.Column="1" TextWrapping="Wrap"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,4,0,0"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Top"
                        Margin="3,4,2,2" Width="32" RenderOptions.BitmapScalingMode="NearestNeighbor"
                        SnapsToDevicePixels="true"
                        Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToImageConvert}}"/>
      <Path x:Name="path" Stretch="Fill" HorizontalAlignment="Right" Margin="1,0,9,0" Width="4"
            Data="M 0,0 L 1,1 0,2 Z" Height="7" Grid.Column="3" Stroke="{x:Null}">
        <Shape.Fill>
          <LinearGradientBrush EndPoint="0.945,0.872" StartPoint="0.055,0.128">
            <GradientStop Color="#FF7C7C7C" Offset="1"/>
            <GradientStop Color="#FF9E9E9E"/>
          </LinearGradientBrush>
        </Shape.Fill>
      </Path>
      <Popup x:Name="PART_Popup" Placement="Right" IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
             AllowsTransparency="true" Focusable="false" PopupAnimation="Fade" Margin="0,0,0,0"
             VerticalAlignment="Top" Grid.ColumnSpan="2">
        <Grid Name="DropDown" SnapsToDevicePixels="true" Margin="0" VerticalAlignment="Stretch">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="4"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="4"/>
          </Grid.ColumnDefinitions>
          <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="4" Height="4" Grid.Row="1"
                     Grid.Column="1" StrokeThickness="0" Margin="-1,-1,0,0">
            <Shape.Fill>
              <RadialGradientBrush RadiusX="0.984" Center="0.017,0.002" GradientOrigin="0.017,0.002" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,3,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <RadialGradientBrush Center="0.032,1.01" GradientOrigin="0.032,1.01" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="3,-1,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <RadialGradientBrush Center="0.996,0.027" GradientOrigin="0.996,0.027" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Stretch" Margin="7,-1,1,0" VerticalAlignment="Top"
                     Width="Auto" Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,7,0,1" VerticalAlignment="Stretch"
                     Width="4" Height="Auto" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Border x:Name="DropDownBorder" SnapsToDevicePixels="true"
                  Background="{DynamicResource ContextMenuBarBackgroundBrush}"
                  BorderBrush="{DynamicResource ContextMenuBarBorderBrush}" BorderThickness="1"
                  CornerRadius="2,2,1,1" Grid.ColumnSpan="1" HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch">
            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
              <Border VerticalAlignment="Stretch" Width="Auto" Height="Auto"
                      BorderBrush="{DynamicResource ContextMenuBarBackgroundBrush}" BorderThickness="1" CornerRadius="1"/>
              <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                  <RowDefinition Height="*"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Path Stretch="Fill" Stroke="#FFE2E4E7" HorizontalAlignment="Left" Margin="24,0,0,0" Width="1"
                      Height="Auto" Data="M 0,0 L 0,1 " Grid.RowSpan="2" Visibility="Visible" Fill="{x:Null}"/>
                <ScrollViewer x:Name="PART_ScrollViewer" VerticalScrollBarVisibility="Auto" Margin="1" SnapsToDevicePixels="true">
                  <Fluent:MenuPanel x:Name="PART_MenuPanel" IsItemsHost="true" KeyboardNavigation.DirectionalNavigation="Contained"/>
                </ScrollViewer>
              </Grid>
            </Grid>
          </Border>
        </Grid>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="border" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="SplitedApplicationMenuSecondLevelItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
      <Style TargetType="{x:Type Fluent:MenuItem}" BasedOn="{StaticResource MenuItemStyle}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="53" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Rectangle Grid.Column="2" HorizontalAlignment="Right" Margin="0,4,23,4"
                 Stroke="{DynamicResource WindowContentBorderBrush}" Width="1"/>
      <Grid HorizontalAlignment="Stretch" Margin="0" Width="Auto" Column="0" ColumnSpan="3">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="0.905*"/>
          <ColumnDefinition x:Name="columnDefinition" Width="23"/>
        </Grid.ColumnDefinitions>
        <Border x:Name="PART_ButtonBorder" Visibility="Collapsed"
                Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
                Margin="0,0,-1,0">
          <Border x:Name="border1" Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                  BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="2"/>
        </Border>
        <Border x:Name="border_Copy" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
                BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
                Grid.Column="1" Background="{DynamicResource TransparentBrush}">
          <Border x:Name="border1_Copy" Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                  BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="1" Visibility="Collapsed"/>
        </Border>
      </Grid>
      <TextBlock x:Name="textBlock_Copy" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,13,3" VerticalAlignment="Center" Grid.Column="1"
                 TextTrimming="None" Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" FontWeight="Bold" Text="{TemplateBinding HeaderedItemsControl.Header}"
                 Width="Auto" Height="Auto" Margin="9,5,3,3" VerticalAlignment="Top" Grid.Column="1"
                 TextTrimming="CharacterEllipsis"/>
      <TextBlock x:Name="textBlockDesc" Text="{TemplateBinding Fluent:MenuItem.Description}" Width="Auto"
                 HorizontalAlignment="Stretch" Height="Auto" Margin="9,22,3,3" VerticalAlignment="Top"
                 Grid.Column="1" TextWrapping="Wrap"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,4,0,0"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Top"
                        Margin="3,4,2,2" Width="32" RenderOptions.BitmapScalingMode="NearestNeighbor"
                        SnapsToDevicePixels="true"
                        Content="{Binding Icon, Converter={StaticResource StringToImageConvert}, RelativeSource={RelativeSource TemplatedParent}}"/>
      <Path x:Name="path" Stretch="Fill" HorizontalAlignment="Right" Margin="1,0,9,0" Width="4"
            Data="M 0,0 L 1,1 0,2 Z" Height="7" Grid.Column="3" Stroke="{x:Null}">
        <Shape.Fill>
          <LinearGradientBrush EndPoint="0.945,0.872" StartPoint="0.055,0.128">
            <GradientStop Color="#FF7C7C7C" Offset="1"/>
            <GradientStop Color="#FF9E9E9E"/>
          </LinearGradientBrush>
        </Shape.Fill>
      </Path>
      <Popup x:Name="PART_Popup" Placement="Right" IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
             AllowsTransparency="true" Focusable="false" PopupAnimation="Fade" Margin="0,0,-4,0"
             VerticalAlignment="Top" Grid.ColumnSpan="2">
        <Grid x:Name="DropDown" SnapsToDevicePixels="true" Margin="0" VerticalAlignment="Stretch">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="10"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="10"/>
          </Grid.ColumnDefinitions>
          <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="4" Height="4" Grid.Row="1"
                     Grid.Column="1" StrokeThickness="0" Margin="-1,-1,0,0">
            <Shape.Fill>
              <RadialGradientBrush RadiusX="0.984" Center="0.017,0.002" GradientOrigin="0.017,0.002" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,3,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <RadialGradientBrush Center="0.032,1.01" GradientOrigin="0.032,1.01" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="3,-1,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <RadialGradientBrush Center="0.996,0.027" GradientOrigin="0.996,0.027" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Stretch" Margin="7,-1,1,0" VerticalAlignment="Top"
                     Width="Auto" Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,7,0,1" VerticalAlignment="Stretch"
                     Width="4" Height="Auto" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Border x:Name="DropDownBorder" SnapsToDevicePixels="true"
                  Background="{DynamicResource ContextMenuBarBackgroundBrush}"
                  BorderBrush="{DynamicResource ContextMenuBarBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
              <Border VerticalAlignment="Stretch" Width="Auto" Height="Auto"
                      BorderBrush="{DynamicResource ContextMenuBarBackgroundBrush}" BorderThickness="1" CornerRadius="1"/>
              <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                  <RowDefinition Height="*"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Path Stretch="Fill" Stroke="#FFE2E4E7" HorizontalAlignment="Left" Margin="24,0,0,0" Width="1"
                      Height="Auto" Data="M 0,0 L 0,1 " Grid.RowSpan="2" Visibility="Visible" Fill="{x:Null}"/>
                <ScrollViewer x:Name="PART_ScrollViewer" Margin="1" Style="{DynamicResource MenuScrollViewer}"
                              SnapsToDevicePixels="true">
                  <Fluent:MenuPanel x:Name="PART_MenuPanel" IsItemsHost="true" KeyboardNavigation.DirectionalNavigation="Contained"/>
                </ScrollViewer>
              </Grid>
            </Grid>
          </Border>
        </Grid>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger SourceName="border_Copy" Property="UIElement.IsMouseOver" Value="true">
        <Setter TargetName="border1_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="PART_ButtonBorder" Property="UIElement.Visibility" Value="Visible"/>
        <Setter TargetName="border_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="MenuItem.IsSubmenuOpen" Value="true">
        <Setter TargetName="border1_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <Style x:Key="ApplicationMenuSecondLevelStyle" TargetType="{x:Type Fluent:MenuItem}">
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
    <Setter Property="Control.FontFamily" Value="{DynamicResource DefaultFontFamily}"/>
    <Setter Property="Control.FontSize" Value="{DynamicResource DefaultFontSize}"/>
    <Setter Property="Control.Foreground" Value="{DynamicResource DefaultFontBrush}"/>
    <Setter Property="Fluent:MenuItem.ResizeMode" Value="None"/>
    <Setter Property="UIElement.SnapsToDevicePixels" Value="true"/>
    <Setter Property="Fluent:FrameworkHelper.UseLayoutRounding" Value="true"/>
    <Setter Property="FrameworkElement.OverridesDefaultStyle" Value="true"/>
    <Setter Property="Control.Template" Value="{StaticResource ApplicationMenuSecondLevelItemTemplate}"/>
    <Style.Triggers>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Fluent:MenuItem.IsSplited" Value="true"/>
          <Condition Property="ItemsControl.HasItems" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter Property="Control.Template" Value="{StaticResource SplitedApplicationMenuSecondLevelItemTemplate}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Fluent:MenuItem.IsSplited" Value="false"/>
          <Condition Property="ItemsControl.HasItems" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter Property="Control.Template" Value="{StaticResource HeaderApplicationMenuSecondLevelItemTemplate}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>
  <ControlTemplate x:Key="ApplicationMenuItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="44" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
              Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
              BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
              Grid.Column="0" Grid.ColumnSpan="3">
        <Border Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"/>
      </Border>
      <TextBlock x:Name="textBlock_Copy" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto"
                 Height="Auto" Margin="9,3,13,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="None"
                 Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto" Height="Auto"
                 Margin="9,3,3,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="CharacterEllipsis"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Center"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Center" Width="32"
                        Margin="3,2,2,2" RenderOptions.BitmapScalingMode="NearestNeighbor" SnapsToDevicePixels="true"
                        Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToImageConvert}}"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="border" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="HeaderApplicationMenuItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
      <Style TargetType="{x:Type Fluent:MenuItem}" BasedOn="{StaticResource ApplicationMenuSecondLevelStyle}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="44" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Border x:Name="border" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
              Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
              BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
              Grid.Column="0" Grid.ColumnSpan="3">
        <Border Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"/>
      </Border>
      <TextBlock x:Name="textBlock_Copy" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto"
                 Height="Auto" Margin="9,3,13,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="None"
                 Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto" Height="Auto"
                 Margin="9,3,3,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="CharacterEllipsis"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Center"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Center" Width="32"
                        Margin="3,2,2,2" RenderOptions.BitmapScalingMode="NearestNeighbor" SnapsToDevicePixels="true"
                        Content="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToImageConvert}}"/>
      <Path x:Name="path" Stretch="Fill" HorizontalAlignment="Right" Margin="1,0,9,0" Width="4"
            Data="M 0,0 L 1,1 0,2 Z" Height="7" Grid.Column="3" Stroke="{x:Null}">
        <Shape.Fill>
          <LinearGradientBrush EndPoint="0.945,0.872" StartPoint="0.055,0.128">
            <GradientStop Color="#FF7C7C7C" Offset="1"/>
            <GradientStop Color="#FF9E9E9E"/>
          </LinearGradientBrush>
        </Shape.Fill>
      </Path>
      <Popup x:Name="PART_Popup" Placement="Relative" IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
             AllowsTransparency="true" Focusable="false" PopupAnimation="Fade" Margin="0,0,0,0"
             VerticalAlignment="Top" Grid.ColumnSpan="2"
             PlacementTarget="{Binding Converter={StaticResource ApplicationMenuRightContentExtractorConvert}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:ApplicationMenu}}}"
             Width="{Binding RightPaneWidth, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:ApplicationMenu}}}"
             Height="{Binding ActualHeight, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:MenuPanel}}}">
        <Grid Name="DropDown" SnapsToDevicePixels="true" Margin="0" VerticalAlignment="Stretch">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="4"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="4"/>
          </Grid.ColumnDefinitions>
          <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="4" Height="4" Grid.Row="1"
                     Grid.Column="1" StrokeThickness="0" Margin="-1,-1,0,0">
            <Shape.Fill>
              <RadialGradientBrush RadiusX="0.984" Center="0.017,0.002" GradientOrigin="0.017,0.002" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,3,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <RadialGradientBrush Center="0.032,1.01" GradientOrigin="0.032,1.01" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="3,-1,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <RadialGradientBrush Center="0.996,0.027" GradientOrigin="0.996,0.027" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Stretch" Margin="7,-1,1,0" VerticalAlignment="Top"
                     Width="Auto" Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,7,0,1" VerticalAlignment="Stretch"
                     Width="4" Height="Auto" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Border x:Name="DropDownBorder" SnapsToDevicePixels="true"
                  Background="{DynamicResource ContextMenuBarBackgroundBrush}"
                  BorderBrush="{DynamicResource ContextMenuBarBorderBrush}" BorderThickness="1"
                  CornerRadius="2,2,1,1" Grid.ColumnSpan="1" HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch">
            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
              <Border VerticalAlignment="Stretch" Width="Auto" Height="Auto"
                      BorderBrush="{DynamicResource ContextMenuBarBackgroundBrush}" BorderThickness="1" CornerRadius="1"/>
              <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                  <RowDefinition Height="*"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ScrollViewer x:Name="PART_ScrollViewer" VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled" Margin="1" SnapsToDevicePixels="true">
                  <Fluent:MenuPanel x:Name="PART_MenuPanel" IsItemsHost="true" KeyboardNavigation.DirectionalNavigation="Contained"/>
                </ScrollViewer>
              </Grid>
            </Grid>
          </Border>
        </Grid>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="border" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <ControlTemplate x:Key="SplitedApplicationMenuItemTemplate" TargetType="{x:Type Fluent:MenuItem}">
    <FrameworkTemplate.Resources>
      <Style TargetType="{x:Type ScrollViewer}" BasedOn="{StaticResource MenuScrollViewer}"/>
      <Style TargetType="{x:Type Fluent:MenuItem}" BasedOn="{StaticResource ApplicationMenuSecondLevelStyle}"/>
    </FrameworkTemplate.Resources>
    <Grid Width="Auto" Height="44" Background="#00000000">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="44"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Rectangle Grid.Column="2" HorizontalAlignment="Right" Margin="0,4,23,4"
                 Stroke="{DynamicResource WindowContentBorderBrush}" Width="1"/>
      <Grid HorizontalAlignment="Stretch" Margin="0" Width="Auto" Column="0" ColumnSpan="3">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="0.905*"/>
          <ColumnDefinition x:Name="columnDefinition" Width="23"/>
        </Grid.ColumnDefinitions>
        <Border x:Name="PART_ButtonBorder" Visibility="Collapsed"
                Background="{DynamicResource ButtonHoverOuterBackgroundBrush}"
                BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
                Margin="0,0,-1,0">
          <Border x:Name="border1" Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                  BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="2"/>
        </Border>
        <Border x:Name="border_Copy" HorizontalAlignment="Stretch" Margin="0" Width="Auto" Visibility="Collapsed"
                BorderBrush="{DynamicResource ButtonHoverOuterBorderBrush}" BorderThickness="1" CornerRadius="2"
                Grid.Column="1" Background="{DynamicResource TransparentBrush}">
          <Border x:Name="border1_Copy" Background="{DynamicResource ButtonHoverInnerBackgroundBrush}"
                  BorderBrush="{DynamicResource ButtonHoverInnerBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="1" Visibility="Collapsed"/>
        </Border>
      </Grid>
      <TextBlock x:Name="textBlock_Copy" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto"
                 Height="Auto" Margin="9,3,13,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="None"
                 Visibility="Hidden" HorizontalAlignment="Left"/>
      <TextBlock x:Name="textBlock" Text="{TemplateBinding HeaderedItemsControl.Header}" Width="Auto" Height="Auto"
                 Margin="9,3,3,3" VerticalAlignment="Center" Grid.Column="1" TextTrimming="CharacterEllipsis"/>
      <Rectangle x:Name="rectangle" Fill="{DynamicResource MenuItemCheckBoxBackgroundBrush}"
                 Stroke="{DynamicResource MenuItemCheckBoxBorderBrush}" Grid.ColumnSpan="1"
                 HorizontalAlignment="Center" VerticalAlignment="Center" Width="40" Height="40" RadiusX="1"
                 RadiusY="1" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <Image x:Name="image" HorizontalAlignment="Center" VerticalAlignment="Center"
             Source="/Fluent;Component/Themes/Office2010/Images/Checked.png" Stretch="None"
             Visibility="Collapsed" SnapsToDevicePixels="true" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
      <ContentPresenter x:Name="iconImage" HorizontalAlignment="Center" Height="32" VerticalAlignment="Center" Width="32"
                        Margin="3,2,2,2" RenderOptions.BitmapScalingMode="NearestNeighbor" SnapsToDevicePixels="true"
                        Content="{Binding Icon, Converter={StaticResource StringToImageConvert}, RelativeSource={RelativeSource TemplatedParent}}"/>
      <Path x:Name="path" Stretch="Fill" HorizontalAlignment="Right" Margin="1,0,9,0" Width="4"
            Data="M 0,0 L 1,1 0,2 Z" Height="7" Grid.Column="3" Stroke="{x:Null}">
        <Shape.Fill>
          <LinearGradientBrush EndPoint="0.945,0.872" StartPoint="0.055,0.128">
            <GradientStop Color="#FF7C7C7C" Offset="1"/>
            <GradientStop Color="#FF9E9E9E"/>
          </LinearGradientBrush>
        </Shape.Fill>
      </Path>
      <Popup x:Name="PART_Popup" Placement="Relative" IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
             AllowsTransparency="true" Focusable="false" PopupAnimation="Fade" Margin="0,0,0,0"
             VerticalAlignment="Top" Grid.ColumnSpan="2"
             PlacementTarget="{Binding Converter={StaticResource ApplicationMenuRightContentExtractorConvert}, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:ApplicationMenu}}}"
             Width="{Binding RightPaneWidth, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:ApplicationMenu}}}"
             Height="{Binding ActualHeight, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Fluent:MenuPanel}}}">
        <Grid x:Name="DropDown" SnapsToDevicePixels="true" Margin="0" VerticalAlignment="Stretch">
          <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="4"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="4"/>
          </Grid.ColumnDefinitions>
          <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="4" Height="4" Grid.Row="1"
                     Grid.Column="1" StrokeThickness="0" Margin="-1,-1,0,0">
            <Shape.Fill>
              <RadialGradientBrush RadiusX="0.984" Center="0.017,0.002" GradientOrigin="0.017,0.002" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,3,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <RadialGradientBrush Center="0.032,1.01" GradientOrigin="0.032,1.01" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="3,-1,0,0" VerticalAlignment="Top" Width="4"
                     Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <RadialGradientBrush Center="0.996,0.027" GradientOrigin="0.996,0.027" RadiusX="0.984" RadiusY="1">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </RadialGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Stretch" Margin="7,-1,1,0" VerticalAlignment="Top"
                     Width="Auto" Height="4" Grid.Column="0" Grid.Row="1">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Rectangle StrokeThickness="0" HorizontalAlignment="Left" Margin="-1,7,0,1" VerticalAlignment="Stretch"
                     Width="4" Height="Auto" Grid.Column="1" Grid.Row="0">
            <Shape.Fill>
              <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5" MappingMode="RelativeToBoundingBox">
                <GradientStop Color="#3F000000" Offset="0"/>
                <GradientStop Color="#00000000" Offset="1"/>
              </LinearGradientBrush>
            </Shape.Fill>
          </Rectangle>
          <Border x:Name="DropDownBorder" SnapsToDevicePixels="true"
                  Background="{DynamicResource ContextMenuBarBackgroundBrush}"
                  BorderBrush="{DynamicResource ContextMenuBarBorderBrush}" BorderThickness="1" CornerRadius="1"
                  Grid.ColumnSpan="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid Width="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
              <Border VerticalAlignment="Stretch" Width="Auto" Height="Auto"
                      BorderBrush="{DynamicResource ContextMenuBarBackgroundBrush}" BorderThickness="1" CornerRadius="1"/>
              <Grid Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                  <RowDefinition Height="*"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Path Stretch="Fill" Stroke="#FFE2E4E7" HorizontalAlignment="Left" Margin="24,0,0,0" Width="1"
                      Height="Auto" Data="M 0,0 L 0,1 " Grid.RowSpan="2" Visibility="Visible" Fill="{x:Null}"/>
                <ScrollViewer x:Name="PART_ScrollViewer" Margin="1" Style="{DynamicResource MenuScrollViewer}"
                              SnapsToDevicePixels="true">
                  <Fluent:MenuPanel x:Name="PART_MenuPanel" IsItemsHost="true" KeyboardNavigation.DirectionalNavigation="Contained"/>
                </ScrollViewer>
              </Grid>
            </Grid>
          </Border>
        </Grid>
      </Popup>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger SourceName="border_Copy" Property="UIElement.IsMouseOver" Value="true">
        <Setter TargetName="border1_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <Trigger Property="MenuItem.IsChecked" Value="true">
        <Setter TargetName="rectangle" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Value="{x:Null}" Property="MenuItem.Icon"/>
          <Condition Property="MenuItem.IsChecked" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="image" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="MenuItem.IsHighlighted" Value="true"/>
          <Condition Property="UIElement.IsEnabled" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="PART_ButtonBorder" Property="UIElement.Visibility" Value="Visible"/>
        <Setter TargetName="border_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </MultiTrigger>
      <Trigger Property="MenuItem.IsSubmenuOpen" Value="true">
        <Setter TargetName="border1_Copy" Property="UIElement.Visibility" Value="Visible"/>
      </Trigger>
      <Trigger Property="UIElement.IsEnabled" Value="false">
        <Setter TargetName="iconImage" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="image" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="textBlock" Property="UIElement.Opacity" Value="0.5"/>
        <Setter TargetName="iconImage" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
        <Setter TargetName="image" Property="UIElement.Effect">
          <Setter.Value>
            <Fluent:GrayscaleEffect/>
          </Setter.Value>
        </Setter>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
  <Style x:Key="ApplicationMenuStyle" TargetType="{x:Type Fluent:MenuItem}">
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
    <Setter Property="Control.FontFamily" Value="{DynamicResource DefaultFontFamily}"/>
    <Setter Property="Control.FontSize" Value="{DynamicResource DefaultFontSize}"/>
    <Setter Property="Control.Foreground" Value="{DynamicResource DefaultFontBrush}"/>
    <Setter Property="Fluent:MenuItem.ResizeMode" Value="None"/>
    <Setter Property="UIElement.SnapsToDevicePixels" Value="true"/>
    <Setter Property="Fluent:FrameworkHelper.UseLayoutRounding" Value="true"/>
    <Setter Property="FrameworkElement.OverridesDefaultStyle" Value="true"/>
    <Setter Property="Control.Template" Value="{StaticResource ApplicationMenuItemTemplate}"/>
    <Style.Triggers>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Fluent:MenuItem.IsSplited" Value="true"/>
          <Condition Property="ItemsControl.HasItems" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter Property="Control.Template" Value="{StaticResource SplitedApplicationMenuItemTemplate}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Fluent:MenuItem.IsSplited" Value="false"/>
          <Condition Property="ItemsControl.HasItems" Value="true"/>
        </MultiTrigger.Conditions>
        <Setter Property="Control.Template" Value="{StaticResource HeaderApplicationMenuItemTemplate}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>
</ResourceDictionary>